def get_next_action(session, message):
    """
    ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    """
    status = session.get("status", "idle")

    if status == "waiting_link":
        session["status"] = "waiting_payment"
        return "âœ… ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­.\nÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¢Ù† ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨."

    if status == "waiting_payment":
        return "ğŸ“Œ Ù†Ø­Ù† ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù„Ø¥ÙƒÙ…Ø§Ù„ ØªÙ†ÙÙŠØ° Ø·Ù„Ø¨Ùƒ."

    return None


def apply_rules(message, intent, session, services, replies):
    """
    ØªØ·Ø¨ÙŠÙ‚ Ù…Ù†Ø·Ù‚ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙˆØ§Ø±Ø¯Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø±Ø¯ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
    """
    # Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø±Ø¯ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ø³ÙŠØ§Ù‚ (Ù…Ø«Ù„: Ø¨Ø¹Øª Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ùˆ Ù…Ù†ØªØ¸Ø± Ø¯ÙØ¹)
    contextual_response = get_next_action(session, message)
    if contextual_response:
        return contextual_response

    # Ù„Ùˆ Ù…ÙÙŠØ´ Ø­Ø§Ù„Ø© Ø³ÙŠØ§Ù‚ÙŠØ©ØŒ ÙŠØªÙ… Ø§Ù„Ø±Ø¯ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
    return replies.get("Ø±Ø¯_Ø§ÙØªØ±Ø§Ø¶ÙŠ", "â“ Ù…Ù† ÙØ¶Ù„Ùƒ ÙˆØ¶Ù‘Ø­ Ø·Ù„Ø¨Ùƒ Ø¨Ø´ÙƒÙ„ Ø£ÙˆØ¶Ø­.")
